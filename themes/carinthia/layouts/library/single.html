{{ define "main" }}
{{ $bannerResource := .Resources.Get "banner.svg" }}
{{ if $bannerResource }}
<div class="library-banner">
    <img src="{{ $bannerResource.RelPermalink }}" alt="Banner for {{ .Title }}" />
</div>
{{ end }}

<div class="library-single">
    <h1 class="sr-only">{{ .Title }}</h1>

    {{ if .Params.summary }}
    <div class="library-summary">
        <p class="summary-text">{{ .Params.summary }}</p>
    </div>
    {{ end }}

    <div class="library-meta">
        {{ if .Params.finished_date }}
        {{ $dateMachine := .Params.finished_date | time.Format "2006-01-02T15:04:05-07:00" }}
        {{ $dateHuman := .Params.finished_date | time.Format ":date_long" }}
        <div class="meta-item">
            <span class="meta-label">Finished</span>
            <time datetime="{{ $dateMachine }}">{{ $dateHuman }}</time>
        </div>
        {{ end }}

        {{ if .Params.category }}
        <div class="meta-item">
            <span class="meta-label">Category</span>
            <span class="category-badge category-{{ .Params.category }}">{{ .Params.category | title }}</span>
        </div>
        {{ end }}

        {{ if .Params.pages }}
        <div class="meta-item">
            <span class="meta-label">Pages</span>
            <span>{{ .Params.pages }}</span>
        </div>
        {{ end }}

        {{ if .Params.average_reading_time }}
        <div class="meta-item">
            <span class="meta-label">Reading Time</span>
            <span>{{ .Params.average_reading_time }} hours</span>
        </div>
        {{ end }}

        {{ if .Params.isbn }}
        <div class="meta-item">
            <span class="meta-label">ISBN</span>
            <div class="isbn-wrapper">
                <span class="isbn">{{ .Params.isbn }}</span>
                <button class="isbn-copy-btn" data-isbn="{{ .Params.isbn }}" aria-label="Copy ISBN">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M16 1H4C2.9 1 2 1.9 2 3V17H4V3H16V1ZM19 5H8C6.9 5 6 5.9 6 7V21C6 22.1 6.9 23 8 23H19C20.1 23 21 22.1 21 21V7C21 5.9 20.1 5 19 5ZM19 21H8V7H19V21Z" fill="currentColor"/>
                    </svg>
                </button>
            </div>
        </div>
        {{ end }}
    </div>

    {{ .Content }}

    {{ partial "terms.html" (dict "taxonomy" "tags" "page" .) }}

    <div class="library-navigation">
        <a href="{{ "library" | relURL }}">&larr; View all Books...</a>
    </div>
</div>
{{ end }}
